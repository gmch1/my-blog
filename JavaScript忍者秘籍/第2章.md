## 第2章	运行时页面的构建过程

### HTML解析和DOM构建

浏览器在收到服务器返回的HTML文件后，调用渲染进程进行HTML解析，根据不同的HTML元素生成DOM树。

如果有遇到不合理的情况，浏览器对此会有相应的优化策略：

```html
<html>
    <header>
	    <div>
    		2333    
        </div>
    </header>
    <body>
        
    </body>
</html>
```

上述这段代码，在浏览器解析生成DOM树时，会检测到相应的错误，自动将div元素移动到body中，以保证页面的正常显示。

在HTML解析过程中，如果有遇到script脚本，浏览器会停止当前DOM的构建，开始指向相应的脚本，执行完毕后，再继续进行HTML解析。

一般来说，JavaScript代码能够在任何程度上修改DOM结构：它能创建新的节点或者移除现有DOM节点。但它仍然不能做某些事情，例如选择和修改还没被创建的节点。这就是为什么把script元素放在页面底部的原因。

### 小结

- 浏览器接受的HTML代码用作创建DOM的蓝图，它是客户端Web应用结构的内部展示阶段。
- 我们使用JavaScript代码来动态地修改DOM以便给Web应用带来动态行为。
- 客户端Web应用的执行分为两个阶段
  - 页面构建代码是用于创建DOM的，而全局JavaScript代码是遇到script节点时执行的。在这个执行过程中，JavaScript代码能够以任意成都改变当前的DOM，还能够注册事件处理器——事件处理器是一种函数，当某个特定事件发生后会被执行。注册事件处理器很容易：使用内置的：addEventListener 方法。
  - 事件处理——在同一时刻，只能处理多个事件中的一个，处理顺序是事件生成的顺序。事件处理阶段大量依赖事件队列，所有的事件都是以其出现的顺序存储在事件队列中。事件循环会检查事件队列的队头，如果监测到了一个事件，那么相应的事件处理器就会被调用。





